---
title: "PA446 Midterm"
author: "Elizabeth Miller"
format: pdf
editor: visual
---

# Part I

## Question 1

Think of a civic problem you would like to address by creating a data application. Include the following in your answer:

1.  Describe the civic problem and its implications for the community. Be as specific as possible.

    Land use and zoning policies in the United States

    public comment?

2.  Briefly describe the data application that can help address the civic problem defined in (1).

    The application will function

    The application will address the issue described in part 1 of the question by

## Question 2

Include the source code and output in your final Quarto document when answering this question. Load the data file called ‘cell.csv’

```{r}
#| label: Set-up
#| warning: false
# load libraries
library(tidyverse)
library(usethis)
library(ggthemes)
library(rvest)
library(gt)
library(gtExtras)

# read csv
cell <- read_csv("./cell.csv")
```

-   Of the states with a texting ban, which one has the highest number of traffic deaths?

```{r}
#| label: Texting Ban Deaths
cell %>%
  filter(text_ban == 1) %>%
  filter(numberofdeaths == max(numberofdeaths))
```

| Answer: California

-   How many states have a cell ban, how many have a texting ban, and how many have both?

```{r}
#| warning: false
#| label: Cell ban and texting ban

cell %>%
  filter(text_ban == 1) %>%
  summarize(unique(state))

cell %>%
  filter(cell_ban == 1) %>%
  summarize(unique(state))

cell %>%
  filter(text_ban == 1 & 
           cell_ban == 1) %>%
  summarize(unique(state))
```

| Answer: 10 have a cell ban, 34 have a texting ban, and 10 have both.

-   What is the average number of deaths in states with a texting ban versus those without?

```{r}
#| warning: false
#| label: Average number of deaths

cell %>%
  filter(text_ban == 1) %>%
  summarize(mean(numberofdeaths))

cell %>%
  filter(text_ban == 0) %>%
  summarize(mean(numberofdeaths))
```

| The average number of traffic deaths is 567 for states with texting bans, and 892 for states without texting bans.

-   Plot the relationship between population and the number of traffic deaths for those with and without a cell ban on the same plot.

```{r, fig.width = 8, fig.height=12}
#| label: Plotting


cell %>%
  group_by(cell_ban) %>%
  mutate(cell_ban = factor(cell_ban,
                           levels = c(0,1),
                           labels = c("No Cell Ban", "Cell Ban")))%>%
  ggplot() +
  geom_col(mapping = aes(x = state, y = numberofdeaths,
                         fill = cell_ban),
           position = position_dodge(0.8)) +
  scale_fill_manual(values = c("No Cell Ban" = "coral4",
                               "Cell Ban" = "darkolivegreen")) +
  labs(title = "Comparing Traffic Deaths \nin States With and 
       \nWithout Cell Phone Bans \nWhile Driving",
       x = "State",
       y = "Number of Traffic Deaths",
       fill = "") +
  coord_flip() +
  theme_wsj()
```

## Question 3

Go to the web link https://www.nytimes.com/topic/subject/elections. Extract data from the “Latest” section and create a table comprising three variables (Article Name, Article Description (the short text after the title), and Author Name). Extract information on at least ten articles. Ideally, the table will have three columns and at least ten rows. Make sure to include both the source code and output in your final Quarto document.

```{r, paged.print=FALSE}
#| label: HTML Scraping

url <- "https://www.nytimes.com/topic/subject/elections"
html <- read_html(url)


title <- html |>
  html_elements(".css-8hzhxf") |> 
  html_text2() # title

descrip <- html |>
  html_element("p.css-1pga48a.e15t083i1") |> 
  html_text2()# description

descrip <- html %>%
  html_elements(".css-1pga48a.e15t083i1") %>%
  html_text2()

authorname <- html |>
  html_elements(".css-1i4y2t3.e140qd2t0") |> 
  html_text2() # author name

# Build the tibble
nyttable <- tibble(title, authorname, descrip)

# i tried using gt() but it got cut off in the rendered pdf
nyttable %>%
  gt() %>%
  cols_label(title = "Article Table",
             authorname = "Author Name",
             descrip = "Description") %>%
  tab_source_note(source_note = md("*Source: New York Times*")) %>%
  tab_options(column_labels.background.color = "skyblue") %>%
  as_raw_html()
  

# this is the only way i could get the tibble to show up in my output
# but unfortunately the entries get cut off
as_tibble(nyttable)


```

# Part II

Link to webpage with CV: <https://emiller1031.github.io/midterm_pa446/>

Link to GitHub repo for midterm: <https://github.com/emiller1031/midterm_pa446>
